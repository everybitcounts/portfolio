---
const GITHUB_REPO = "https://github.com/everybitcounts/public-projects";

const projects = [
  {
    id: "terraform-academy",
    title: "Terraform Academy Platform",
    description: "A learning platform I built for teaching Infrastructure as Code. It has interactive labs, progress tracking, and supports multiple organizations with SSO.",
    category: "Full-Stack",
    tags: ["React", "TypeScript", "Serverless", "Stripe", "Docker"],
    github: "terraform-academy-platform",
    features: [
      "Interactive IaC coding labs",
      "Progress tracking and certifications",
      "Multi-tenant organizations with SSO",
      "Subscription management"
    ],
    architecture: {
      type: "serverless",
      components: [
        { name: "React SPA", layer: "frontend" },
        { name: "Vercel Edge", layer: "cdn" },
        { name: "Serverless Functions", layer: "api" },
        { name: "PostgreSQL", layer: "database" },
        { name: "Stripe", layer: "payments" },
        { name: "Docker Labs", layer: "compute" }
      ]
    }
  },
  {
    id: "aws-dr-automation",
    title: "AWS DR Automation",
    description: "Cross-region disaster recovery that fails over in under 15 minutes. I built this using Route53, RDS replication, and Step Functions to automate the entire process.",
    category: "AWS Infrastructure",
    tags: ["Terraform", "AWS", "Step Functions", "Route53", "RDS"],
    github: "aws-dr-automation",
    features: [
      "RTO under 15 min, RPO under 5 min",
      "Health-based DNS failover",
      "Cross-region RDS replication",
      "Automated runbook execution"
    ],
    architecture: {
      type: "multi-region",
      components: [
        { name: "Route53", layer: "dns" },
        { name: "Global Accelerator", layer: "edge" },
        { name: "ECS/EKS", layer: "compute" },
        { name: "RDS Multi-AZ", layer: "database" },
        { name: "S3 CRR", layer: "storage" },
        { name: "Step Functions", layer: "orchestration" }
      ]
    }
  },
  {
    id: "aws-eks-observability",
    title: "AWS EKS Observability",
    description: "A complete observability stack for Kubernetes. Prometheus for metrics, Loki for logs, Tempo for traces, all tied together with Grafana dashboards.",
    category: "Kubernetes",
    tags: ["EKS", "Prometheus", "Grafana", "Loki", "Terraform"],
    github: "aws-eks-observability",
    features: [
      "Unified metrics, logs, traces",
      "IRSA for secure AWS access",
      "Long-term S3 storage",
      "Pre-built dashboards"
    ],
    architecture: {
      type: "kubernetes",
      components: [
        { name: "Prometheus/Thanos", layer: "metrics" },
        { name: "Loki", layer: "logs" },
        { name: "Tempo", layer: "traces" },
        { name: "Grafana", layer: "visualization" },
        { name: "Alertmanager", layer: "alerting" },
        { name: "S3 Backend", layer: "storage" }
      ]
    }
  },
  {
    id: "aws-security-compliance",
    title: "AWS Security Compliance",
    description: "Security scanning and auto-remediation built on Security Hub, GuardDuty, and Config. When something drifts out of compliance, Lambda functions fix it automatically.",
    category: "Security",
    tags: ["Security Hub", "GuardDuty", "Config", "Lambda", "Terraform"],
    github: "aws-security-compliance",
    features: [
      "CIS/PCI-DSS/SOC2/HIPAA compliance",
      "Auto-remediation workflows",
      "Real-time security alerts",
      "Compliance dashboards"
    ],
    architecture: {
      type: "event-driven",
      components: [
        { name: "Security Hub", layer: "aggregation" },
        { name: "GuardDuty", layer: "detection" },
        { name: "AWS Config", layer: "compliance" },
        { name: "EventBridge", layer: "routing" },
        { name: "Lambda", layer: "remediation" },
        { name: "SNS/Slack", layer: "notifications" }
      ]
    }
  },
  {
    id: "aws-landing-zone",
    title: "AWS Landing Zone",
    description: "Multi-account setup using AWS Organizations and Control Tower. I automated account provisioning and set up SCPs to keep everything secure by default.",
    category: "Governance",
    tags: ["Organizations", "Control Tower", "SCPs", "IAM", "Terraform"],
    github: "aws-landing-zone",
    features: [
      "OU hierarchy management",
      "Preventive SCPs",
      "Account factory automation",
      "Centralized logging"
    ],
    architecture: {
      type: "multi-account",
      components: [
        { name: "Management Account", layer: "root" },
        { name: "Security OU", layer: "security" },
        { name: "Infrastructure OU", layer: "shared" },
        { name: "Workloads OU", layer: "production" },
        { name: "Sandbox OU", layer: "development" },
        { name: "Log Archive", layer: "audit" }
      ]
    }
  },
  {
    id: "aws-cicd-pipeline",
    title: "AWS CI/CD Pipeline",
    description: "Production deployment pipeline using CodePipeline and CodeBuild. Supports blue-green and canary deployments with automatic rollback if something goes wrong.",
    category: "DevOps",
    tags: ["CodePipeline", "CodeBuild", "CodeDeploy", "ECR", "Terraform"],
    github: "aws-cicd-pipeline",
    features: [
      "Blue-green deployments",
      "Cross-account promotion",
      "Container scanning",
      "Automated rollback"
    ],
    architecture: {
      type: "pipeline",
      components: [
        { name: "CodeCommit/GitHub", layer: "source" },
        { name: "CodeBuild", layer: "build" },
        { name: "ECR", layer: "registry" },
        { name: "CodeDeploy", layer: "deploy" },
        { name: "ECS/EKS", layer: "runtime" },
        { name: "CloudWatch", layer: "monitoring" }
      ]
    }
  }
];

const getCategoryColor = (category: string) => {
  const colors: Record<string, string> = {
    "Full-Stack": "#8b5cf6",
    "AWS Infrastructure": "#f97316",
    "Kubernetes": "#06b6d4",
    "Security": "#ef4444",
    "Governance": "#10b981",
    "DevOps": "#3b82f6"
  };
  return colors[category] || "#6b7280";
};
---

<section class="projects section" id="projects">
  <div class="container">
    <div class="section-header">
      <span class="section-label">My Work</span>
      <h2 class="section-title">Projects I Have Built</h2>
      <p class="section-description">
        Here are some of the infrastructure and platform projects I have worked on. 
        Each one taught me something new about building reliable systems at scale.
      </p>
    </div>
    
    <div class="projects-grid">
      {projects.map((project) => (
        <div class="project-card">
          <div class="project-header">
            <div class="project-meta">
              <span class="project-category" style={`--cat-color: ${getCategoryColor(project.category)}`}>
                {project.category}
              </span>
            </div>
            <h3 class="project-title">{project.title}</h3>
            <p class="project-description">{project.description}</p>
          </div>
          
          <div class="architecture-diagram">
            <div class="diagram-title">Architecture</div>
            <div class={`diagram diagram-${project.architecture.type}`}>
              {project.architecture.components.map((component, index) => (
                <div class="diagram-node" style={`--delay: ${index * 0.1}s`}>
                  <span class="node-name">{component.name}</span>
                  <span class="node-layer">{component.layer}</span>
                </div>
              ))}
            </div>
          </div>
          
          <div class="project-features">
            <h4>Key Features</h4>
            <ul>
              {project.features.map((feature) => (
                <li>{feature}</li>
              ))}
            </ul>
          </div>
          
          <div class="project-tags">
            {project.tags.map((tag) => (
              <span class="tag">{tag}</span>
            ))}
          </div>
          
          <a href={`${GITHUB_REPO}/tree/main/${project.github}`} target="_blank" rel="noopener noreferrer" class="view-code-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            View Code
          </a>
        </div>
      ))}
    </div>
    
    <div class="more-projects">
      <p>Plus 6 more projects including AWS Cost Optimizer, Instance Scheduler, Server Tagging Module, Sprint Pulse, Homeschool Planner, and Quantum Viper Game.</p>
      <a href={GITHUB_REPO} target="_blank" rel="noopener noreferrer" class="view-all-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
        View All Projects
      </a>
    </div>
  </div>
</section>

<style>
  .projects-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 32px;
  }

  .project-card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 16px;
    padding: 32px;
    display: flex;
    flex-direction: column;
    gap: 24px;
    transition: all 0.3s;
  }

  .project-card:hover {
    border-color: var(--accent);
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
  }

  .project-category {
    display: inline-flex;
    padding: 4px 12px;
    background: color-mix(in srgb, var(--cat-color) 15%, transparent);
    color: var(--cat-color);
    border-radius: 100px;
    font-size: 0.75rem;
    font-weight: 600;
  }

  .project-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 12px 0 8px;
    color: var(--text-primary);
  }

  .project-description {
    font-size: 0.9rem;
    color: var(--text-secondary);
    line-height: 1.6;
  }

  .architecture-diagram {
    background: var(--bg-secondary);
    border: 1px solid var(--card-border);
    border-radius: 12px;
    padding: 20px;
  }

  .diagram-title {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 16px;
  }

  .diagram {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
  }

  .diagram-node {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 8px;
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    text-align: center;
    animation: fadeIn 0.4s ease-out forwards;
    animation-delay: var(--delay);
    opacity: 0;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  .node-name {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-primary);
  }

  .node-layer {
    font-size: 0.65rem;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .diagram-serverless .diagram-node:nth-child(1) { grid-column: 1; }
  .diagram-serverless .diagram-node:nth-child(2) { grid-column: 2; }
  .diagram-serverless .diagram-node:nth-child(3) { grid-column: 3; }
  .diagram-serverless .diagram-node:nth-child(4) { grid-column: 1; grid-row: 2; }
  .diagram-serverless .diagram-node:nth-child(5) { grid-column: 2; grid-row: 2; }
  .diagram-serverless .diagram-node:nth-child(6) { grid-column: 3; grid-row: 2; }

  .diagram-multi-region .diagram-node:nth-child(1) { grid-column: 2; }
  .diagram-multi-region .diagram-node:nth-child(2) { grid-column: 2; grid-row: 2; }
  .diagram-multi-region .diagram-node:nth-child(3) { grid-column: 1; grid-row: 3; }
  .diagram-multi-region .diagram-node:nth-child(4) { grid-column: 2; grid-row: 3; }
  .diagram-multi-region .diagram-node:nth-child(5) { grid-column: 3; grid-row: 3; }
  .diagram-multi-region .diagram-node:nth-child(6) { grid-column: 2; grid-row: 4; }

  .project-features {
    padding-top: 16px;
    border-top: 1px solid var(--card-border);
  }

  .project-features h4 {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 12px;
  }

  .project-features ul {
    list-style: none;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }

  .project-features li {
    font-size: 0.85rem;
    color: var(--text-secondary);
    padding-left: 16px;
    position: relative;
  }

  .project-features li::before {
    content: 'âœ“';
    position: absolute;
    left: 0;
    color: #22c55e;
    font-size: 0.75rem;
  }

  .project-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding-top: 16px;
    border-top: 1px solid var(--card-border);
  }

  .tag {
    padding: 4px 10px;
    background: var(--bg-tertiary);
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 500;
    color: var(--text-muted);
  }

  .view-code-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 16px;
    padding: 10px 20px;
    background: transparent;
    border: 1px solid var(--card-border);
    border-radius: 8px;
    color: var(--text-secondary);
    font-size: 0.875rem;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.2s;
  }

  .view-code-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: color-mix(in srgb, var(--accent) 10%, transparent);
  }

  .view-code-btn svg {
    flex-shrink: 0;
  }

  .more-projects {
    margin-top: 48px;
    padding: 32px;
    background: var(--bg-secondary);
    border: 1px solid var(--card-border);
    border-radius: 16px;
    text-align: center;
  }

  .more-projects p {
    margin-bottom: 20px;
    font-size: 1rem;
    color: var(--text-secondary);
  }

  .view-all-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 12px 24px;
    background: var(--accent);
    border: none;
    border-radius: 8px;
    color: white;
    font-size: 0.9rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.2s;
  }

  .view-all-btn:hover {
    background: var(--accent-hover);
    transform: translateY(-2px);
  }

  @media (max-width: 1024px) {
    .projects-grid {
      grid-template-columns: 1fr;
    }

    .diagram {
      grid-template-columns: repeat(2, 1fr);
    }

    .project-features ul {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 480px) {
    .diagram {
      grid-template-columns: 1fr;
    }
  }
</style>
